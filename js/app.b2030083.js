(function(){var e={6700:function(e,t,n){var a={"./af":3906,"./af.js":3906,"./ar":902,"./ar-dz":3853,"./ar-dz.js":3853,"./ar-kw":299,"./ar-kw.js":299,"./ar-ly":6825,"./ar-ly.js":6825,"./ar-ma":6379,"./ar-ma.js":6379,"./ar-sa":7700,"./ar-sa.js":7700,"./ar-tn":2059,"./ar-tn.js":2059,"./ar.js":902,"./az":6043,"./az.js":6043,"./be":7936,"./be.js":7936,"./bg":4078,"./bg.js":4078,"./bm":4014,"./bm.js":4014,"./bn":9554,"./bn-bd":7114,"./bn-bd.js":7114,"./bn.js":9554,"./bo":6529,"./bo.js":6529,"./br":5437,"./br.js":5437,"./bs":9647,"./bs.js":9647,"./ca":9951,"./ca.js":9951,"./cs":6113,"./cs.js":6113,"./cv":7965,"./cv.js":7965,"./cy":5858,"./cy.js":5858,"./da":3515,"./da.js":3515,"./de":2831,"./de-at":6263,"./de-at.js":6263,"./de-ch":1127,"./de-ch.js":1127,"./de.js":2831,"./dv":4510,"./dv.js":4510,"./el":8616,"./el.js":8616,"./en-au":4595,"./en-au.js":4595,"./en-ca":3545,"./en-ca.js":3545,"./en-gb":9609,"./en-gb.js":9609,"./en-ie":3727,"./en-ie.js":3727,"./en-il":3302,"./en-il.js":3302,"./en-in":6305,"./en-in.js":6305,"./en-nz":9128,"./en-nz.js":9128,"./en-sg":4569,"./en-sg.js":4569,"./eo":650,"./eo.js":650,"./es":6358,"./es-do":4214,"./es-do.js":4214,"./es-mx":8639,"./es-mx.js":8639,"./es-us":232,"./es-us.js":232,"./es.js":6358,"./et":7279,"./et.js":7279,"./eu":5515,"./eu.js":5515,"./fa":7981,"./fa.js":7981,"./fi":7090,"./fi.js":7090,"./fil":9208,"./fil.js":9208,"./fo":2799,"./fo.js":2799,"./fr":3463,"./fr-ca":2213,"./fr-ca.js":2213,"./fr-ch":2848,"./fr-ch.js":2848,"./fr.js":3463,"./fy":1468,"./fy.js":1468,"./ga":8163,"./ga.js":8163,"./gd":2898,"./gd.js":2898,"./gl":6312,"./gl.js":6312,"./gom-deva":682,"./gom-deva.js":682,"./gom-latn":9178,"./gom-latn.js":9178,"./gu":5009,"./gu.js":5009,"./he":2795,"./he.js":2795,"./hi":7009,"./hi.js":7009,"./hr":6506,"./hr.js":6506,"./hu":9565,"./hu.js":9565,"./hy-am":3864,"./hy-am.js":3864,"./id":5626,"./id.js":5626,"./is":6649,"./is.js":6649,"./it":151,"./it-ch":5348,"./it-ch.js":5348,"./it.js":151,"./ja":9830,"./ja.js":9830,"./jv":3751,"./jv.js":3751,"./ka":3365,"./ka.js":3365,"./kk":5980,"./kk.js":5980,"./km":9571,"./km.js":9571,"./kn":5880,"./kn.js":5880,"./ko":6809,"./ko.js":6809,"./ku":6773,"./ku.js":6773,"./ky":5505,"./ky.js":5505,"./lb":553,"./lb.js":553,"./lo":1237,"./lo.js":1237,"./lt":1563,"./lt.js":1563,"./lv":1057,"./lv.js":1057,"./me":6495,"./me.js":6495,"./mi":3096,"./mi.js":3096,"./mk":3874,"./mk.js":3874,"./ml":6055,"./ml.js":6055,"./mn":7747,"./mn.js":7747,"./mr":7113,"./mr.js":7113,"./ms":8687,"./ms-my":7948,"./ms-my.js":7948,"./ms.js":8687,"./mt":4532,"./mt.js":4532,"./my":4655,"./my.js":4655,"./nb":6961,"./nb.js":6961,"./ne":2512,"./ne.js":2512,"./nl":8448,"./nl-be":2936,"./nl-be.js":2936,"./nl.js":8448,"./nn":9031,"./nn.js":9031,"./oc-lnc":5174,"./oc-lnc.js":5174,"./pa-in":118,"./pa-in.js":118,"./pl":3448,"./pl.js":3448,"./pt":3518,"./pt-br":2447,"./pt-br.js":2447,"./pt.js":3518,"./ro":817,"./ro.js":817,"./ru":262,"./ru.js":262,"./sd":8990,"./sd.js":8990,"./se":3842,"./se.js":3842,"./si":7711,"./si.js":7711,"./sk":756,"./sk.js":756,"./sl":3772,"./sl.js":3772,"./sq":6187,"./sq.js":6187,"./sr":732,"./sr-cyrl":5713,"./sr-cyrl.js":5713,"./sr.js":732,"./ss":9455,"./ss.js":9455,"./sv":9770,"./sv.js":9770,"./sw":959,"./sw.js":959,"./ta":6459,"./ta.js":6459,"./te":5302,"./te.js":5302,"./tet":7975,"./tet.js":7975,"./tg":1294,"./tg.js":1294,"./th":9304,"./th.js":9304,"./tk":4613,"./tk.js":4613,"./tl-ph":8668,"./tl-ph.js":8668,"./tlh":8190,"./tlh.js":8190,"./tr":4506,"./tr.js":4506,"./tzl":3440,"./tzl.js":3440,"./tzm":9852,"./tzm-latn":2350,"./tzm-latn.js":2350,"./tzm.js":9852,"./ug-cn":730,"./ug-cn.js":730,"./uk":99,"./uk.js":99,"./ur":2100,"./ur.js":2100,"./uz":6002,"./uz-latn":6322,"./uz-latn.js":6322,"./uz.js":6002,"./vi":4207,"./vi.js":4207,"./x-pseudo":4674,"./x-pseudo.js":4674,"./yo":570,"./yo.js":570,"./zh-cn":3644,"./zh-cn.js":3644,"./zh-hk":2591,"./zh-hk.js":2591,"./zh-mo":9503,"./zh-mo.js":9503,"./zh-tw":8080,"./zh-tw.js":8080};function s(e){var t=r(e);return n(t)}function r(e){if(!n.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}s.keys=function(){return Object.keys(a)},s.resolve=r,e.exports=s,s.id=6700},3666:function(e,t,n){"use strict";var a=n(9242),s=n(3396),r=n(9797),i=n(4111),o=n(9234),l=n(4606),c=n(2231),u=n(8166);function d(e,t,n,d,m,v){const f=(0,s.up)("router-view"),h=(0,s.up)("NotInTelegram"),g=(0,s.up)("AppBottomNavigation");return(0,s.wg)(),(0,s.j4)(r.q,{id:"app"},{default:(0,s.w5)((()=>[e.isTelegram&&e.isRegistered?((0,s.wg)(),(0,s.j4)(i.L,{key:0,density:"compact"},{default:(0,s.w5)((()=>[(0,s.Wm)(o.C),(0,s.Wm)(c.d,{"hide-slider":""},{default:(0,s.w5)((()=>[(0,s.Wm)(u.L,{to:{name:"events"},class:"text-subtitle-1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" События ")])),_:1}),(0,s.Wm)(u.L,{to:{name:"my_events"},class:"text-subtitle-1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Мои записи ")])),_:1})])),_:1}),(0,s.Wm)(o.C)])),_:1})):(0,s.kq)("",!0),e.isTelegram?((0,s.wg)(),(0,s.j4)(l.O,{key:1},{default:(0,s.w5)((()=>[e.isTelegram?((0,s.wg)(),(0,s.j4)(f,{key:0},{default:(0,s.w5)((({Component:e,route:t})=>[(0,s.Wm)(a.uT,{name:"slide-x",mode:"out-in"},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)((0,s.LL)(e),{key:t.path}))])),_:2},1024)])),_:1})):(0,s.kq)("",!0)])),_:1})):((0,s.wg)(),(0,s.j4)(l.O,{key:2},{default:(0,s.w5)((()=>[(0,s.Wm)(h,{class:"mt-12",onOnSetDefaultUserClick:v.setTestTelegramUserId},null,8,["onOnSetDefaultUserClick"])])),_:1})),e.isTelegram?((0,s.wg)(),(0,s.j4)(g,{key:3})):(0,s.kq)("",!0)])),_:1})}var m=n(7328),v=n(8281),f=n(7457),h=n(4959);function g(e,t,n,a,r,i){return(0,s.wg)(),(0,s.j4)(m.N,{elevation:"0",style:{"flex-grow":"0","background-color":"transparent"}},{default:(0,s.w5)((()=>[(0,s.Wm)(f.f,null,{default:(0,s.w5)((()=>[e.$route?.meta.goBackButton?((0,s.wg)(),(0,s.j4)(v.T,{key:0,class:"rounded-pill",variant:"plain",color:"primary",icon:"mdi-chevron-left",onClick:t[0]||(t[0]=t=>e.$router.go(-1))})):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(f.f,{class:"main-shadow",rounded:"xl",color:"primary"},{default:(0,s.w5)((()=>[(0,s.Wm)(v.T,{to:{name:"search"},class:"text-subtitle-2 main-shadow"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-magnify")])),_:1}),(0,s.Uk)(" Поиск ")])),_:1}),(0,s.Wm)(v.T,{to:{name:"my_events"},class:"text-subtitle-2 main-shadow"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{size:"small"},{default:(0,s.w5)((()=>[(0,s.Uk)("mdi-account")])),_:1}),(0,s.Uk)(" Мои записи ")])),_:1})])),_:1})])),_:1})}var p={name:"AppBottomNavigation"},w=n(89);const b=(0,w.Z)(p,[["render",g]]);var _=b,k=n(5701),y=n(3145);const j={class:"d-flex flex-column align-center"},x={class:"text-center"},D=(0,s._)("div",{class:"mt-4 text-center"}," Приложение должно быть открыто в Telegram ",-1);function W(e,t,a,r,i,o){return(0,s.wg)(),(0,s.iD)("div",j,[(0,s._)("div",x,[(0,s.Wm)(k.V,null,{default:(0,s.w5)((()=>[(0,s.Wm)(y.f,{src:n(2133)},null,8,["src"])])),_:1})]),D])}var T={name:"NotInTelegram",data:()=>({selected_tg_id:1})};const E=(0,w.Z)(T,[["render",W]]);var U=E,I=n(4042),C=n(6572),z=n(1888),S=n(6422),L=n(416),A=n(230),V=n(9689);function F(e,t,n,r,i,o){const l=(0,s.up)("vue-tel-input");return(0,s.wg)(),(0,s.j4)(L.K,{style:{"max-width":"600px"}},{default:(0,s.w5)((()=>[(0,s.Wm)(I._,{variant:"text"},{default:(0,s.w5)((()=>[(0,s.Wm)(C.E,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Регистрация ")])),_:1}),(0,s.Wm)(z.Z,{class:"mt-6"},{default:(0,s.w5)((()=>[(0,s.Wm)(S.O,{modelValue:e.form,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form=t),onSubmit:(0,a.iM)(o.onSubmit,["prevent"])},{default:(0,s.w5)((()=>[(0,s.Wm)(V.h,{modelValue:e.user.fio,"onUpdate:modelValue":t[0]||(t[0]=t=>e.user.fio=t),rules:[o.required],class:"mb-2",clearable:"",label:"Как вас зовут?",variant:"outlined"},null,8,["modelValue","rules"]),(0,s.Wm)(l,{modelValue:e.user.phone,"onUpdate:modelValue":t[1]||(t[1]=t=>e.user.phone=t),style:{height:"60px","font-size":"1rem"},class:"mb-6"},null,8,["modelValue"]),(0,s.Wm)(v.T,{disabled:!e.form,loading:e.loading,type:"submit",color:"success",variant:"flat",rounded:"",block:""},{default:(0,s.w5)((()=>[(0,s.Uk)(" Зарегистрироваться ")])),_:1},8,["disabled","loading"])])),_:1},8,["modelValue","onSubmit"])])),_:1})])),_:1}),(0,s.Wm)(A.v,{modelValue:e.error,"onUpdate:modelValue":t[3]||(t[3]=t=>e.error=t),color:"error"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Ой! Произошла ошибка. Проверьте подключение к интернету ")])),_:1},8,["modelValue"])])),_:1})}var O=n(70);const Z=()=>O.ZP.create({baseURL:"http://185.185.69.122/api_booking",headers:{post:{"Content-type":"application/x-www-form-urlencoded"}},timeout:1e4}),R={events_all:"/servicetg",event_info:"/booking/search",event_subscribe:"/booking",event_unsubscribe:"/booking",client_info:"/client/info_client",client_events:"/booking/my_booking",client_check_tg:"/client/info_client",client_add:"/client",search_service:"/search/service",search_users:"/search/users"};var Y={getAllEvents(){return Z().get(R.events_all).then((e=>e.data)).catch((e=>{throw e}))},getEventData(e,t){return Z().get(R.event_info,{params:{id_service:e,tg_id:t}}).then((e=>e.data)).catch((e=>{throw e}))},subscribeToEvent({event_uuid:e,start_tz:t,end_tz:n,service_uuid:a,client_tgid:s,creator_uuid:r,size:i}){return Z().post(R.event_subscribe,{event_day_id:e,booking_dt_start:t,booking_dt_end:n,service_id:a,client_info:{tg_id:s,client_id:null},creator_event_id:r,size:i}).then((e=>e.data)).catch((e=>{throw e}))},unsubscribeFromEvent(e){return Z().delete(R.event_unsubscribe,{params:{id_bookings:e}}).then((e=>e.data)).catch((e=>{throw e}))},getClientInfo(e){return Z().get(R.client_info,{params:{tg_id:e}}).then((e=>e.data)).catch((e=>{throw e}))},getClientEvents({tg_id:e,client_id:t}){return Z().get(R.client_events,{params:{id_tg:e,id_client:t}}).then((e=>e.data)).catch((e=>{throw e}))},checkClientTg(e){return Z().get(R.client_check_tg,{params:{tg_id:e}}).then((e=>e.data)).catch((e=>{throw e}))},addClient({tg_id:e,name:t,phone:n}){return Z().post(R.client_add,{tg_id:e,name:t,phone:n}).then((e=>e.data)).catch((e=>{throw e}))},searchServices(){return Z().get(R.search_service).then((e=>e.data)).catch((e=>{throw e}))},searchUsers(){return Z().get(R.search_users).then((e=>e.data)).catch((e=>{throw e}))}},M={name:"UserRegister",data:()=>({user:{fio:null,phone:null},loading:!1,form:!1,error:!1}),methods:{onSubmit(){this.form&&(this.loading=!0,Y.addClient({tg_id:this.$store.getters.userTgId,name:this.user.fio,phone:this.user.phone}).then((()=>{this.$router.go({name:"events"})})).catch((()=>{this.error=!0,setTimeout((()=>this.error=!1),1e4)})).finally((()=>{this.loading=!1})))},required(e){return!!e||"Обязательно для заполнения"}}};const B=(0,w.Z)(M,[["render",F]]);var N=B;window.addEventListener("keypress",(()=>console.log("click")));var H={name:"App",components:{AppBottomNavigation:_,NotInTelegram:U,UserRegister:N},data:()=>({isTelegram:!1,isRegistered:!1,loaded:!1}),async mounted(){const e=window.Telegram.WebApp;await e.ready(),this.setTheme(e.colorScheme),this.$store.commit("setTheme",e.colorScheme),e.onEvent("themeChanged",(()=>this.setTheme(e.colorScheme)));const t=e.initDataUnsafe;t.user.id?(this.$store.commit("setUserData",{tg_id:t.user.id}),this.isTelegram=!0):this.isTelegram=!1;const n=await Y.checkClientTg(t.user.id);void 0!==n.tg_id&&(this.isRegistered=!0),this.loaded=!0},methods:{setTheme(e){console.log("theme",e),"dark"==e?(this.$vuetify.theme.name="dark",this.$store.commit("setTheme","dark"),console.log("set dark")):(this.$vuetify.theme.name="light",this.$store.commit("setTheme","light"),console.log("set light"))},setTestTelegramUserId(e){this.$store.commit("setUserData",{tg_id:e}),this.isTelegram=!0}}};const $=(0,w.Z)(H,[["render",d]]);var q=$,P=(n(2135),n(8957)),K=n(1214),G=n(8604),J=n(6064),Q=(0,P.Rd)({blueprint:K.n,theme:{defaultTheme:"light",themes:{light:{dark:!1,colors:{primary:J.Z.blue.darken2,background:"#f5f5f5"}},dark:{dark:!0,colors:{primary:J.Z.blue.lighten1}}}},locale:{locale:"ru",fallback:"en",messages:{ru:G.Z}}});async function X(){const e=await n.e(461).then(n.t.bind(n,3657,23));e.load({google:{families:["Roboto:100,300,400,500,700,900&display=swap"]}})}var ee=n(2483);function te(e,t,n,a,r,i){const o=(0,s.up)("EventSearch"),l=(0,s.up)("ApiLoader");return(0,s.wg)(),(0,s.j4)(L.K,{style:{"max-width":"600px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.n4,null,{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"ma-4 mt-6"})])),fallback:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1}))])),_:1})}var ne=n(7139),ae=n(8248),se=n(8341),re=n(4722);const ie=(0,s._)("div",{class:"text-h5 mb-8 font-weight-medium"},"Поиск",-1),oe={key:0},le={key:1},ce={key:1},ue={key:0},de={key:1},me={key:0},ve={key:1},fe={key:0},he={key:1},ge={key:0},pe={key:1};function we(e,t,n,r,i,o){const l=(0,s.up)("ApiError"),c=(0,s.up)("ApiLoader"),u=(0,s.up)("EventInfoCard"),d=(0,s.up)("router-link"),m=(0,s.up)("NoEvents"),g=(0,s.up)("UserInfoCard");return(0,s.wg)(),(0,s.iD)("div",null,[ie,e.error?((0,s.wg)(),(0,s.iD)("div",oe,[(0,s.Wm)(l,{text:e.error},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",le,[(0,s.Wm)(S.O,null,{default:(0,s.w5)((()=>[(0,s.Wm)(V.h,{modelValue:e.searchString,"onUpdate:modelValue":t[0]||(t[0]=t=>e.searchString=t),variant:"solo",color:"primary",placeholder:"сплав на каноэ, секция гребли","append-inner-icon":"mdi-magnify","onClick:appendInner":o.doSearch,onKeydown:(0,a.D2)(o.doSearch,["enter"])},null,8,["modelValue","onClick:appendInner","onKeydown"])])),_:1}),e.searchLoading?((0,s.wg)(),(0,s.j4)(c,{key:0})):((0,s.wg)(),(0,s.iD)("div",ce,[(0,s.Wm)(f.f,{modelValue:e.selectedSearchTab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedSearchTab=t),rounded:"xl",variant:"plain",color:"primary",style:{width:"100%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(v.T,{class:"flex-grow-1",rounded:"none",value:"services"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-calendar",size:"small",class:"mr-1"}),(0,s.Uk)(" События "+(0,ne.zw)(e.searchActive?"("+e.searchResults.services.length+")":""),1)])),_:1}),(0,s.Wm)(v.T,{class:"flex-grow-1",rounded:"none",value:"users"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-account",size:"small",class:"mr-1"}),(0,s.Uk)(" Пользователи "+(0,ne.zw)(e.searchActive?"("+e.searchResults.users.length+")":""),1)])),_:1})])),_:1},8,["modelValue"]),e.searchActive?((0,s.wg)(),(0,s.j4)(se.Oo,{key:0,modelValue:e.selectedSearchTab,"onUpdate:modelValue":t[2]||(t[2]=t=>e.selectedSearchTab=t),class:"mt-10"},{default:(0,s.w5)((()=>[(0,s.Wm)(re.H,{value:"services"},{default:(0,s.w5)((()=>[e.searchResults.services.length?((0,s.wg)(),(0,s.iD)("div",ue,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.searchResults.services,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{to:{name:"event",params:{uuid:e.item.id}},style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{title:e?.item.name_service,duration:e?.item.duration,price:e?.item.price_service,"max-booking":e?.item.max_booking},null,8,["title","duration","price","max-booking"])])),_:2},1032,["to"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",de,[(0,s.Wm)(m,{class:"ma-10"})]))])),_:1}),(0,s.Wm)(re.H,{value:"users"},{default:(0,s.w5)((()=>[e.searchResults.users.length?((0,s.wg)(),(0,s.iD)("div",me,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(e.searchResults.users,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{to:{name:"user",params:{uuid:e.item.id}},style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{title:e?.item.name,username:e?.item.login},null,8,["title","username"])])),_:2},1032,["to"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",ve,[(0,s.Wm)(m,{class:"ma-10"})]))])),_:1})])),_:1},8,["modelValue"])):((0,s.wg)(),(0,s.j4)(se.Oo,{key:1,modelValue:e.selectedSearchTab,"onUpdate:modelValue":t[3]||(t[3]=t=>e.selectedSearchTab=t),class:"mt-10"},{default:(0,s.w5)((()=>[(0,s.Wm)(re.H,{value:"services"},{default:(0,s.w5)((()=>[r.allServices.length?((0,s.wg)(),(0,s.iD)("div",fe,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.allServices,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e.id},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{to:{name:"event",params:{uuid:e.id}},style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{title:e?.name_service,duration:e?.duration,price:e?.price_service,"max-booking":e?.max_booking},null,8,["title","duration","price","max-booking"])])),_:2},1032,["to"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",he,[(0,s.Wm)(m,{class:"ma-10"})]))])),_:1}),(0,s.Wm)(re.H,{value:"users"},{default:(0,s.w5)((()=>[r.allUsers.length?((0,s.wg)(),(0,s.iD)("div",ge,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(r.allUsers,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e.id},{default:(0,s.w5)((()=>[(0,s.Wm)(d,{to:{name:"user",params:{uuid:e.id}},style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(g,{title:e?.name,username:e?.login},null,8,["title","username"])])),_:2},1032,["to"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",pe,[(0,s.Wm)(m,{class:"ma-10"})]))])),_:1})])),_:1},8,["modelValue"]))]))]))])}var be=n(7584);const _e={class:"flex-grow-1"},ke={class:"d-flex justify-space-between align-center"},ye={class:"text-h6 font-weight-medium"},je={class:"text-body-1"},xe={class:"d-flex text-subtitle-2 text-medium-emphasis mt-1"},De={class:"flex-grow-0 ml-4"};function We(e,t,n,a,r,i){const o=(0,s.up)("IconAndText");return(0,s.wg)(),(0,s.j4)(be.V,null,{default:(0,s.w5)((({isHovering:e,props:t})=>[(0,s.Wm)(I._,(0,s.dG)({class:["main-shadow main-transition rounded-xl d-flex align-center mb-4 pt-2 pb-3 pl-4",e?"border-primary":"border-transparent"],variant:"flat"},t),{default:(0,s.w5)((()=>[(0,s._)("div",_e,[(0,s._)("div",ke,[(0,s._)("div",ye,(0,ne.zw)(n.title),1),(0,s._)("div",je,(0,ne.zw)(i.priceFormatted),1)]),(0,s._)("div",xe,[n.duration?((0,s.wg)(),(0,s.j4)(o,{key:0,icon:"mdi-clock-outline",text:i.durationFormatted},null,8,["text"])):(0,s.kq)("",!0),n.maxBooking?((0,s.wg)(),(0,s.j4)(o,{key:1,icon:"mdi-account-group",value:n.maxBooking,text:"чел"},null,8,["value"])):(0,s.kq)("",!0)])]),(0,s._)("div",De,[(0,s.Wm)(k.V,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-chevron-right",color:"primary"})])),_:1})])])),_:2},1040,["class"])])),_:1})}const Te={class:"d-flex align-center mr-3"},Ee={class:"ml-1"};function Ue(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",Te,[n.icon?((0,s.wg)(),(0,s.j4)(h.t,{key:0,size:"x-small"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,ne.zw)(n.icon),1)])),_:1})):(0,s.kq)("",!0),(0,s._)("span",Ee,(0,ne.zw)(n.value)+" "+(0,ne.zw)(n.text),1)])}var Ie={name:"IconAndText",props:["icon","value","text"]};const Ce=(0,w.Z)(Ie,[["render",Ue]]);var ze=Ce,Se=n(6797),Le=n.n(Se),Ae={name:"EventInfoCard",props:["title","duration","maxBooking","price"],components:{IconAndText:ze},computed:{priceFormatted:function(){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(this.price)},durationFormatted:function(){return Le().duration(this.duration).locale("ru").humanize()}}};const Ve=(0,w.Z)(Ae,[["render",We]]);var Fe=Ve;const Oe={class:"d-flex flex-grow-1 align-center"},Ze={class:"text-center"},Re={class:"ml-4"},Ye={class:"text-h6"},Me={class:"text-body-2 text-medium-emphasis"},Be={class:"flex-grow-0 ml-4"};function Ne(e,t,n,a,r,i){return(0,s.wg)(),(0,s.j4)(be.V,null,{default:(0,s.w5)((({isHovering:e,props:t})=>[(0,s.Wm)(I._,(0,s.dG)({class:["main-shadow main-transition rounded-xl d-flex align-center mb-4 pt-2 pb-3 pl-4",e?"border-primary":"border-transparent"],variant:"flat"},t),{default:(0,s.w5)((()=>[(0,s._)("div",Oe,[(0,s._)("div",Ze,[(0,s.Wm)(k.V,{color:"primary",variant:"tonal"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-account-circle"})])),_:1})]),(0,s._)("div",Re,[(0,s._)("div",Ye,(0,ne.zw)(n.title),1),(0,s._)("div",Me," @"+(0,ne.zw)(n.username),1)])]),(0,s._)("div",Be,[(0,s.Wm)(k.V,null,{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-chevron-right",color:"primary"})])),_:1})])])),_:2},1040,["class"])])),_:1})}var He={name:"UserInfoCard",props:["title","username"],components:{},computed:{}};const $e=(0,w.Z)(He,[["render",Ne]]);var qe=$e;const Pe={class:"text-center text-medium-emphasis"},Ke=(0,s._)("div",null," Нет событий ",-1);function Ge(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",Pe,[(0,s.Wm)(h.t,{icon:"mdi-eye-outline",size:"large",class:"ma-2"}),Ke])}var Je={name:"NoEvents"};const Qe=(0,w.Z)(Je,[["render",Ge]]);var Xe=Qe,et=n(4870),tt=n(9633);const nt={keys:["name_service"]},at={keys:["login","name"]};var st={name:"EventSearch",components:{EventInfoCard:Fe,UserInfoCard:qe,NoEvents:Xe},data:()=>({searchError:{status:!1,details:""},searchLoading:!1,searchString:"",selectedSearchTab:0,searchActive:!1,searchResults:{services:[],users:[]}}),async setup(){const e=(0,et.iH)({}),t=(0,et.iH)({});try{e.value=await Y.searchServices()}catch(s){console.log(s)}try{t.value=await Y.searchUsers()}catch(s){console.log(s)}const n=new tt.Z(e.value,nt),a=new tt.Z(t.value,at);return{allServices:e,allUsers:t,servicesSearchList:n,userSearchList:a}},methods:{doSearch(){this.searchString.length?(this.searchResults.services=this.servicesSearchList.search(this.searchString),this.searchResults.users=this.userSearchList.search(this.searchString),this.searchActive=!0):this.searchActive=!1}}};const rt=(0,w.Z)(st,[["render",we]]);var it=rt,ot=n(5906);const lt={class:"d-flex flex-column text-center ma-12"},ct={class:"mt-2"},ut={key:0},dt={key:1};function mt(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",lt,[(0,s._)("div",null,[(0,s.Wm)(ot.L,{indeterminate:"",color:"primary"})]),(0,s._)("div",ct,[n.text?((0,s.wg)(),(0,s.iD)("div",ut,(0,ne.zw)(n.text),1)):((0,s.wg)(),(0,s.iD)("div",dt,"Загрузка..."))])])}var vt={name:"ApiLoader",props:["text"]};const ft=(0,w.Z)(vt,[["render",mt]]);var ht=ft,gt={name:"SearchView",components:{EventSearch:it,ApiLoader:ht}};const pt=(0,w.Z)(gt,[["render",te]]);var wt=pt;function bt(e,t,n,a,r,i){const o=(0,s.up)("EventSubscribe"),l=(0,s.up)("ApiLoader");return(0,s.wg)(),(0,s.j4)(L.K,{style:{"max-width":"600px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.n4,null,{default:(0,s.w5)((()=>[(0,s.Wm)(o)])),fallback:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1}))])),_:1})}var _t=n(1334);const kt={key:0},yt={key:1},jt={key:1},xt={class:"mt-4 mb-6 ml-4 mr-4"},Dt={key:0};function Wt(e,t,n,a,r,i){const o=(0,s.up)("ApiError"),l=(0,s.up)("SubscribeResultCard"),c=(0,s.up)("EventInfo"),u=(0,s.up)("EventCalendar"),d=(0,s.up)("EventTimes");return a.error?((0,s.wg)(),(0,s.iD)("div",kt,[(0,s.Wm)(o,{text:a.error},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",yt,[r.eventDialog.show?((0,s.wg)(),(0,s.j4)(l,{key:0,successful:r.eventDialog.success,info:r.eventSubscribeReply?.bookingInfo,onCloseclick:i.closeEventDialog},null,8,["successful","info","onCloseclick"])):((0,s.wg)(),(0,s.iD)("div",jt,[(0,s._)("div",xt,[(0,s.Wm)(c,{title:a.eventInfo?.name_service,duration:a.eventInfo?.duration,"max-booking":a.eventInfo?.max_booking,price:a.eventInfo?.price_service},null,8,["title","duration","max-booking","price"])]),(0,s.Wm)(I._,{class:"rounded-xl main-shadow"},{default:(0,s.w5)((()=>[(0,s.Wm)(C.E,{class:"text-primary text-subtitle-1"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Запись на мероприятие ")])),_:1}),(0,s.Wm)(z.Z,{class:"pa-0"},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{dates:a.eventDates,onDayclick:i.onDayClick},null,8,["dates","onDayclick"])])),_:1}),a.selectedDayTimes?.length>0?((0,s.wg)(),(0,s.iD)("div",Dt,[(0,s.Wm)(C.E,{class:"text-medium-emphasis text-subtitle-2"},{default:(0,s.w5)((()=>[(0,s.Uk)(" Доступное время ")])),_:1}),(0,s.Wm)(z.Z,null,{default:(0,s.w5)((()=>[(0,s.Wm)(d,{times:a.selectedDayTimes,onTimeclick:i.onTimeClick},null,8,["times","onTimeclick"])])),_:1})])):(0,s.kq)("",!0),i.readyToSubcsribe?((0,s.wg)(),(0,s.j4)(_t.h,{key:1},{default:(0,s.w5)((()=>[(0,s.Wm)(v.T,{color:"success",variant:"flat",rounded:"",block:"",onClick:i.subscribeToEvent},{default:(0,s.w5)((()=>[(0,s.Uk)(" Записаться ")])),_:1},8,["onClick"])])),_:1})):(0,s.kq)("",!0)])),_:1})]))]))}n(7658);const Tt={class:"d-flex justify-space-between align-center"},Et={class:"text-h6 font-weight-medium"},Ut={class:"text-body-1"},It={class:"d-flex text-subtitle-2 text-medium-emphasis mt-1"};function Ct(e,t,n,a,r,i){const o=(0,s.up)("IconAndText");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s._)("div",Tt,[(0,s._)("div",Et,(0,ne.zw)(n.title),1),(0,s._)("div",Ut,(0,ne.zw)(i.priceFormatted),1)]),(0,s._)("div",It,[n.duration?((0,s.wg)(),(0,s.j4)(o,{key:0,icon:"mdi-clock-outline",text:i.durationFormatted},null,8,["text"])):(0,s.kq)("",!0),n.maxBooking?((0,s.wg)(),(0,s.j4)(o,{key:1,icon:"mdi-account-group",value:n.maxBooking,text:"чел"},null,8,["value"])):(0,s.kq)("",!0)])])}var zt={name:"EventInfo",props:["title","duration","maxBooking","price"],components:{IconAndText:ze},computed:{priceFormatted:function(){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(this.price)},durationFormatted:function(){return Le().duration(this.duration).locale("ru").humanize()}}};const St=(0,w.Z)(zt,[["render",Ct]]);var Lt=St;function At(e,t,n,a,r,i){const o=(0,s.up)("v-date-picker");return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(o,{attributes:i.attributes,onDayclick:i.onDayClick,modelValue:r.selectedDate,"onUpdate:modelValue":t[0]||(t[0]=e=>r.selectedDate=e),"select-attribute":r.selectAttribute,"available-dates":i.availableDates,"disabled-dates":{},"is-expanded":"",locale:"ru-RU","is-dark":e.$store.state.themeDark,style:{border:"none"}},null,8,["attributes","onDayclick","modelValue","select-attribute","available-dates","is-dark"])])}var Vt={name:"EventCalendar",data(){return{selectedDate:null,selectAttribute:{highlight:{fillMode:"solid",color:"blue"}}}},props:["dates"],methods:{onDayClick(e){console.log(e),null!=this.selectedDate?this.$emit("dayclick",e.date):this.$emit("dayclick",null)}},computed:{attributes(){return[{dates:this.dates.map((e=>e.date))}]},availableDates(){return this.dates.map((e=>({start:e?.start,end:e?.start})))}}};const Ft=(0,w.Z)(Vt,[["render",At]]);var Ot=Ft,Zt=n(9591),Rt=n(9371),Yt=n(2127);const Mt={key:0,class:"text-center"};function Bt(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(Zt.i,{density:"compact"},{default:(0,s.w5)((()=>[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(n.times,(e=>((0,s.wg)(),(0,s.j4)(Rt.l,{key:e.uuid,value:e,"active-color":"primary",class:"rounded-pill mt-1 mb-1",onClick:t=>i.onTimeSelect(e),disabled:e.already_subscribed},{prepend:(0,s.w5)((()=>[(0,s.Wm)(Yt.V,{class:"text-button"},{default:(0,s.w5)((()=>[(0,s.Uk)((0,ne.zw)(i.getTime(e?.start))+" - "+(0,ne.zw)(i.getTime(e?.end)),1)])),_:2},1024)])),append:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-account",size:"x-small",class:"mr-1"}),(0,s.Uk)(" "+(0,ne.zw)(e?.size)+" мест ",1)])),default:(0,s.w5)((()=>[e.already_subscribed?((0,s.wg)(),(0,s.iD)("div",Mt," вы уже записаны ")):(0,s.kq)("",!0)])),_:2},1032,["value","onClick","disabled"])))),128))])),_:1})])}var Nt={name:"EventTimes",props:["times"],data:()=>({selectedTime:null}),methods:{onTimeSelect(e){this.$emit("timeclick",e)},getTime(e){return Le()(e).locale("ru").format("LT")}},watch:{}};const Ht=(0,w.Z)(Nt,[["render",Bt]]);var $t=Ht,qt=n(7869),Pt=n(9196);const Kt={class:"text-disabled"};function Gt(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",null,[(0,s.Wm)(qt.w,{variant:"text",type:"error",color:"red",icon:"mdi-close-network"},{default:(0,s.w5)((()=>[(0,s.Wm)(Pt.g,null,{default:(0,s.w5)((()=>[(0,s.Uk)("Что-то пошло не так")])),_:1}),(0,s._)("code",Kt,(0,ne.zw)(n.text),1)])),_:1})])}var Jt={name:"ApiError",props:["text"]};const Qt=(0,w.Z)(Jt,[["render",Gt]]);var Xt=Qt,en=n(6596);const tn={key:0},nn=(0,s._)("div",{class:"text-h6 ma-2"}," Вы записаны ",-1),an={class:"text-left font-weight-medium mb-1"},sn={key:0},rn={key:0},on={key:1},ln={class:"text-left mt-4"},cn={class:"text-medium-emphasis"},un={key:1},dn=(0,s._)("div",{class:"text-h6 ma-2"}," Ошибка ",-1);function mn(e,t,n,a,r,i){const o=(0,s.up)("IconAndText");return(0,s.wg)(),(0,s.j4)(I._,{class:"main-shadow rounded-xl"},{default:(0,s.w5)((()=>[n.successful?((0,s.wg)(),(0,s.iD)("div",tn,[(0,s.Wm)(en._,{class:"d-flex flex-column align-center justify-center text-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{class:"ma-2",icon:"mdi-check-bold",color:"success"}),nn])),_:1}),(0,s.Wm)(z.Z,{class:"text-left"},{default:(0,s.w5)((()=>[(0,s._)("div",an,(0,ne.zw)(n.info?.subscription_service?.name_service),1),i.timeIntervalFormatted?((0,s.wg)(),(0,s.iD)("div",sn,[i.timeIntervalFormatted.same_day?((0,s.wg)(),(0,s.iD)("div",rn,[(0,s.Wm)(o,{icon:"mdi-clock-outline",text:i.timeIntervalFormatted.start_time+" - "+i.timeIntervalFormatted.end_time},null,8,["text"]),(0,s.Wm)(o,{icon:"mdi-calendar",text:i.timeIntervalFormatted.date},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",on,[(0,s.Wm)(o,{icon:"mdi-calendar",text:"c "+i.timeIntervalFormatted.start+" по "+i.timeIntervalFormatted.end},null,8,["text"])]))])):(0,s.kq)("",!0),(0,s._)("div",ln,[(0,s.Uk)((0,ne.zw)(n.info?.companyInfo?.name)+" ",1),(0,s._)("span",cn," @"+(0,ne.zw)(n.info?.companyInfo.login),1)])])),_:1})])):((0,s.wg)(),(0,s.iD)("div",un,[(0,s.Wm)(en._,{class:"d-flex flex-column align-center justify-center text-center"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{class:"ma-2",icon:"mdi-close-circle",color:"red"}),dn])),_:1})])),(0,s.Wm)(_t.h,{class:"justify-end"},{default:(0,s.w5)((()=>[n.successful?((0,s.wg)(),(0,s.j4)(v.T,{key:0,color:"primary",onClick:t[0]||(t[0]=t=>e.$router.push({name:"search"}))},{default:(0,s.w5)((()=>[(0,s.Uk)("Все события")])),_:1})):(0,s.kq)("",!0),n.successful?((0,s.wg)(),(0,s.j4)(v.T,{key:1,color:"success",onClick:i.closeEventDialog},{default:(0,s.w5)((()=>[(0,s.Uk)("Записаться еще")])),_:1},8,["onClick"])):(0,s.kq)("",!0),n.successful?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(v.T,{key:2,color:"red",onClick:i.closeEventDialog},{default:(0,s.w5)((()=>[(0,s.Uk)("Попробовать снова")])),_:1},8,["onClick"]))])),_:1})])),_:1})}var vn={name:"SubscribeResultCard",props:["successful","info"],components:{IconAndText:ze},methods:{closeEventDialog(){this.$emit("closeclick")}},computed:{timeIntervalFormatted:function(){const e=this.info?.dt_start,t=this.info?.dt_end;return null==e||null==t?null:Le()(e).format("YYYY-MM-DD")===Le()(t).format("YYYY-MM-DD")?{same_day:!0,start_time:Le()(e).locale("ru").format("LT"),end_time:Le()(t).locale("ru").format("LT"),date:Le()(e).locale("ru").format("LL")}:{same_day:!1,start:Le()(e).locale("ru").format("LLL"),end:Le()(t).locale("ru").format("LLL")}}}};const fn=(0,w.Z)(vn,[["render",mn]]);var hn=fn,gn=n(65),pn={name:"EventSubscribe",components:{EventInfo:Lt,EventCalendar:Ot,EventTimes:$t,ApiError:Xt,SubscribeResultCard:hn},async setup(){const e=(0,ee.yj)(),t=(0,gn.oR)(),n=(0,et.iH)({}),a=(0,et.iH)(null),s=async()=>{try{n.value=await Y.getEventData(e.params.uuid,t.getters.userTgId)}catch(s){a.value=s}};await s();const r=n.value?.serviceInfo,i=n.value?.companyInfo,o=n.value?.intervalsInfo,l=(0,et.iH)(null),c=(0,et.iH)({});return{event:n,eventInfo:r,providerInfo:i,getEventInfo:s,eventDates:o,selectedDayTimes:l,selectedEvent:c,error:a}},data(){return{eventDialog:{show:!1,success:!1},eventSubscribeReply:{}}},computed:{readyToSubcsribe:function(){return!!(this.selectedEvent?.start&&this.selectedEvent?.end&&this.selectedEvent?.size&&this.selectedEvent?.uuid)}},methods:{onDayClick(e){null!=e?(this.selectedDayTimes=this.getTimesForClickedDate(e),console.log(this.selectedDayTimes.length),this.selectedEvent=null):(this.selectedDayTimes=null,this.selectedEvent=null)},getTimesForClickedDate(e){const t=[];for(const n of this.event.intervalsInfo){let a=new Date(new Date(n.start).toDateString());a.getTime()===e.getTime()&&t.push({start:n?.start,end:n?.end,size:n?.size,uuid:n?.creator_event_id,already_subscribed:n?.status_booking})}return t},onTimeClick(e){this.selectedEvent=e},async subscribeToEvent(){this.readyToSubcsribe&&(this.eventSubscribeReply={},await Y.subscribeToEvent({event_uuid:this.selectedEvent?.uuid,start_tz:this.selectedEvent?.start,end_tz:this.selectedEvent?.end,size:1,service_uuid:this.eventInfo?.id,creator_uuid:this.providerInfo?.id,client_tgid:this.$store.getters.userTgId}).then((e=>{this.eventDialog.show=!0,this.eventDialog.success=!0,this.eventSubscribeReply=e})).catch((()=>{this.eventDialog.show=!0,this.eventDialog.success=!1})))},closeEventDialog(){this.eventDialog.show=!1,this.eventDialog.success&&this.$router.go(this.$router.currentRoute.path)}}};const wn=(0,w.Z)(pn,[["render",Wt]]);var bn=wn,_n={name:"EventSubscribeView",components:{EventSubscribe:bn,ApiLoader:ht}};const kn=(0,w.Z)(_n,[["render",bt]]);var yn=kn;function jn(e,t,n,a,r,i){const o=(0,s.up)("UserPage"),l=(0,s.up)("ApiLoader");return(0,s.wg)(),(0,s.j4)(L.K,{style:{"max-width":"600px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.n4,null,{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"ma-4 mt-6"})])),fallback:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1}))])),_:1})}const xn={key:0},Dn={key:1},Wn=(0,s._)("div",{class:"text-h6 font-weight-medium mt-10 mb-8"},"События пользователя",-1),Tn={key:0},En={key:1};function Un(e,t,n,a,r,i){const o=(0,s.up)("ApiError"),l=(0,s.up)("UserPageInfoCard"),c=(0,s.up)("EventInfoCard"),u=(0,s.up)("router-link"),d=(0,s.up)("NoEvents");return e.error?((0,s.wg)(),(0,s.iD)("div",xn,[(0,s.Wm)(o,{text:e.error},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",Dn,[(0,s.Wm)(l,{title:a.userInfo?.name,username:a.userInfo?.login},null,8,["title","username"]),Wn,a.userEvents.length?((0,s.wg)(),(0,s.iD)("div",Tn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.userEvents,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(u,{to:{name:"event",params:{uuid:e.id}},style:{"text-decoration":"none"}},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:e?.name_service,duration:e?.duration,price:e?.price_service,"max-booking":e?.max_booking},null,8,["title","duration","price","max-booking"])])),_:2},1032,["to"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",En,[(0,s.Wm)(d,{class:"ma-10"})]))]))}const In={class:"text-center"},Cn={class:"mt-2"},zn={class:"text-h6"},Sn={class:"text-body-2 text-medium-emphasis"};function Ln(e,t,n,a,r,i){return(0,s.wg)(),(0,s.j4)(I._,{class:"main-shadow main-transition rounded-xl d-flex flex-column align-center mb-4 pa-4",variant:"flat"},{default:(0,s.w5)((()=>[(0,s._)("div",In,[(0,s.Wm)(k.V,{color:"primary",variant:"tonal"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-account-circle"})])),_:1})]),(0,s._)("div",Cn,[(0,s._)("div",zn,(0,ne.zw)(n.title),1),(0,s._)("div",Sn," @"+(0,ne.zw)(n.username),1)])])),_:1})}var An={name:"UserPageInfoCard",props:["title","username"],components:{},computed:{}};const Vn=(0,w.Z)(An,[["render",Ln]]);var Fn=Vn;const On=()=>O.ZP.create({baseURL:"http://185.185.69.122/api_users",headers:{post:{"Content-type":"application/x-www-form-urlencoded"}},timeout:1e4}),Zn={user_info:"/users/information_performers"};var Rn={getUserInfo(e){return On().get(Zn.user_info,{params:{company_id:e}}).then((e=>e.data)).catch((e=>{throw e}))}},Yn={name:"UserPage",components:{UserPageInfoCard:Fn,EventInfoCard:Fe,NoEvents:Xe,ApiError:Xt},async setup(){const e=(0,ee.yj)(),t=(0,et.iH)(null),n=e.params.uuid,a=(0,et.iH)({});try{a.value=await Rn.getUserInfo(n),console.log("kek")}catch(o){t.value=o,console.log("error")}const r=(0,s.Fl)((()=>a.value?.info_user)),i=(0,s.Fl)((()=>a.value?.settings[0]?.data));return{user_uuid:n,user:a,userInfo:r,userEvents:i}}};const Mn=(0,w.Z)(Yn,[["render",Un]]);var Bn=Mn,Nn={name:"UserPageView",components:{UserPage:Bn}};const Hn=(0,w.Z)(Nn,[["render",jn]]);var $n=Hn;function qn(e,t,n,a,r,i){const o=(0,s.up)("MyAccount"),l=(0,s.up)("ApiLoader");return(0,s.wg)(),(0,s.j4)(L.K,{style:{"max-width":"600px"}},{default:(0,s.w5)((()=>[((0,s.wg)(),(0,s.j4)(s.n4,null,{default:(0,s.w5)((()=>[(0,s.Wm)(o,{class:"ma-4 mt-6"})])),fallback:(0,s.w5)((()=>[(0,s.Wm)(l)])),_:1}))])),_:1})}const Pn={key:0},Kn={key:1},Gn=(0,s._)("div",{class:"text-h5 font-weight-medium"},"Мои записи",-1),Jn={key:0},Qn={key:1},Xn={key:0},ea={key:1};function ta(e,t,n,a,r,i){const o=(0,s.up)("ApiError"),l=(0,s.up)("AccountInfo"),c=(0,s.up)("MyEventInfoCard"),u=(0,s.up)("NoEvents"),d=(0,s.up)("EventUnsubscribeDialog");return a.error?((0,s.wg)(),(0,s.iD)("div",Pn,[(0,s.Wm)(o,{text:a.error},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",Kn,[Gn,(0,s.Wm)(I._,{class:"mt-8 mb-6 pa-4 rounded-xl main-shadow"},{default:(0,s.w5)((()=>[a.userData.name?((0,s.wg)(),(0,s.j4)(l,{key:0,name:a.userData.name,phone:a.userData.phone},null,8,["name","phone"])):(0,s.kq)("",!0)])),_:1}),(0,s.Wm)(f.f,{modelValue:e.selectedEventsTab,"onUpdate:modelValue":t[0]||(t[0]=t=>e.selectedEventsTab=t),rounded:"xl",variant:"plain",color:"primary",style:{width:"100%"}},{default:(0,s.w5)((()=>[(0,s.Wm)(v.T,{class:"flex-grow-1",rounded:"none",value:"upcoming"},{default:(0,s.w5)((()=>[(0,s.Uk)("Предстоящие")])),_:1}),(0,s.Wm)(v.T,{class:"flex-grow-1",rounded:"none",value:"past"},{default:(0,s.w5)((()=>[(0,s.Uk)("Прошедшие")])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(se.Oo,{modelValue:e.selectedEventsTab,"onUpdate:modelValue":t[1]||(t[1]=t=>e.selectedEventsTab=t),class:"mt-10"},{default:(0,s.w5)((()=>[(0,s.Wm)(re.H,{value:"upcoming"},{default:(0,s.w5)((()=>[a.userEventsUpcoming.length?((0,s.wg)(),(0,s.iD)("div",Jn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.userEventsUpcoming,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{title:e.name,start:e.start,end:e.end,onOnDeleteClicked:t=>i.showUnsubscribeEvent(e)},null,8,["title","start","end","onOnDeleteClicked"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",Qn,[(0,s.Wm)(u,{class:"ma-10"})]))])),_:1}),(0,s.Wm)(re.H,{value:"past"},{default:(0,s.w5)((()=>[a.userEventsPast.length?((0,s.wg)(),(0,s.iD)("div",Xn,[((0,s.wg)(!0),(0,s.iD)(s.HY,null,(0,s.Ko)(a.userEventsPast,(e=>((0,s.wg)(),(0,s.j4)(ae._,{key:e},{default:(0,s.w5)((()=>[(0,s.Wm)(c,{gone:"true",title:e.name,start:e.start,end:e.end,onOnDeleteClicked:t=>i.showUnsubscribeEvent(e)},null,8,["title","start","end","onOnDeleteClicked"])])),_:2},1024)))),128))])):((0,s.wg)(),(0,s.iD)("div",ea,[(0,s.Wm)(u,{class:"ma-10"})]))])),_:1})])),_:1},8,["modelValue"]),(0,s.Wm)(d,{visible:e.eventUnsubscribeDialog.show,onOnUnsubscribeClick:t[2]||(t[2]=e=>i.unsubscribeEvent(e)),onClose:i.hideUnsubscribeEvent,"event-name":e.eventUnsubscribeDialog.eventName,"event-start":e.eventUnsubscribeDialog.eventStart,"event-end":e.eventUnsubscribeDialog.eventEnd,"event-id":e.eventUnsubscribeDialog.eventId},null,8,["visible","onClose","event-name","event-start","event-end","event-id"])]))}const na={class:"d-flex align-center"},aa={class:"text-center"},sa={class:"ml-4"},ra={class:"text-h6 mb-1"},ia={class:"text-body-2 text-medium-emphasis"};function oa(e,t,n,a,r,i){return(0,s.wg)(),(0,s.iD)("div",na,[(0,s._)("div",aa,[(0,s.Wm)(k.V,{color:"primary",variant:"tonal"},{default:(0,s.w5)((()=>[(0,s.Wm)(h.t,{icon:"mdi-account-circle"})])),_:1})]),(0,s._)("div",sa,[(0,s._)("div",ra,(0,ne.zw)(n.name),1),(0,s._)("div",ia,(0,ne.zw)(n.phone),1)])])}var la={name:"AccountInfo",props:["name","phone"]};const ca=(0,w.Z)(la,[["render",oa]]);var ua=ca;const da={class:"flex-grow-1"},ma={class:"d-flex justify-space-between align-center"},va={class:"text-h6 font-weight-medium"},fa={class:"text-body-1"},ha={class:"d-flex text-subtitle-2 text-medium-emphasis mt-1"},ga={key:0},pa={key:1},wa={class:"ma-2"};function ba(e,t,n,a,r,i){const o=(0,s.up)("IconAndText");return(0,s.wg)(),(0,s.j4)(be.V,null,{default:(0,s.w5)((({props:e})=>[(0,s.Wm)(I._,(0,s.dG)({class:"main-shadow main-transition rounded-xl d-flex align-center mb-4 pt-2 pb-3 pl-4",variant:"flat"},e,{disabled:n.gone}),{default:(0,s.w5)((()=>[(0,s._)("div",da,[(0,s._)("div",ma,[(0,s._)("div",va,(0,ne.zw)(n.title),1),(0,s._)("div",fa,(0,ne.zw)(i.priceFormatted),1)]),(0,s._)("div",ha,[i.timeIntervalFormatted.same_day?((0,s.wg)(),(0,s.iD)("div",ga,[(0,s.Wm)(o,{icon:"mdi-clock-outline",text:i.timeIntervalFormatted.start_time+" - "+i.timeIntervalFormatted.end_time},null,8,["text"]),(0,s.Wm)(o,{icon:"mdi-calendar",text:i.timeIntervalFormatted.date},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",pa,[(0,s.Wm)(o,{icon:"mdi-calendar",text:"c "+i.timeIntervalFormatted.start+" по "+i.timeIntervalFormatted.end},null,8,["text"])]))])]),(0,s._)("div",wa,[(0,s.Wm)(k.V,null,{default:(0,s.w5)((()=>[n.gone?(0,s.kq)("",!0):((0,s.wg)(),(0,s.j4)(v.T,{key:0,onClick:i.onDeleteClicked,icon:"mdi-close",variant:"text",color:"error",size:"small"},null,8,["onClick"]))])),_:1})])])),_:2},1040,["disabled"])])),_:1})}var _a={name:"MyEventInfoCard",props:["title","start","end","price","gone"],components:{IconAndText:ze},computed:{priceFormatted:function(){return new Intl.NumberFormat("ru-RU",{style:"currency",currency:"RUB"}).format(this.price)},durationFormatted:function(){return Le().duration(this.duration).locale("ru").humanize()},timeIntervalFormatted:function(){const e=this.start,t=this.end;return Le()(e).format("YYYY-MM-DD")===Le()(t).format("YYYY-MM-DD")?{same_day:!0,start_time:Le()(e).locale("ru").format("LT"),end_time:Le()(t).locale("ru").format("LT"),date:Le()(e).locale("ru").format("LL")}:{same_day:!1,start:Le()(e).locale("ru").format("LLL"),end:Le()(t).locale("ru").format("LLL")}}},methods:{onDeleteClicked(){this.$emit("onDeleteClicked")}}};const ka=(0,w.Z)(_a,[["render",ba]]);var ya=ka,ja=n(1108);const xa={class:"mb-1"},Da={class:"text-body-2 text-medium-emphasis"},Wa={key:0},Ta={key:1};function Ea(e,t,n,r,i,o){const l=(0,s.up)("IconAndText");return(0,s.wg)(),(0,s.j4)(ja.B,{modelValue:o.show,"onUpdate:modelValue":t[2]||(t[2]=e=>o.show=e),persistent:"","max-width":"600px"},{default:(0,s.w5)((()=>[(0,s.Wm)(I._,null,{default:(0,s.w5)((()=>[(0,s.Wm)(C.E,null,{default:(0,s.w5)((()=>[(0,s.Uk)(" Отменить запись? ")])),_:1}),(0,s.Wm)(z.Z,null,{default:(0,s.w5)((()=>[(0,s._)("div",xa,(0,ne.zw)(n.eventName),1),(0,s._)("div",Da,[o.timeIntervalFormatted.same_day?((0,s.wg)(),(0,s.iD)("div",Wa,[(0,s.Wm)(l,{icon:"mdi-clock-outline",text:o.timeIntervalFormatted.start_time+" - "+o.timeIntervalFormatted.end_time},null,8,["text"]),(0,s.Wm)(l,{icon:"mdi-calendar",text:o.timeIntervalFormatted.date},null,8,["text"])])):((0,s.wg)(),(0,s.iD)("div",Ta,[(0,s.Wm)(l,{icon:"mdi-calendar",text:"c "+o.timeIntervalFormatted.start+" по "+o.timeIntervalFormatted.end},null,8,["text"])]))])])),_:1}),(0,s.Wm)(_t.h,{class:"justify-end"},{default:(0,s.w5)((()=>[(0,s.Wm)(v.T,{color:"error",flat:"",onClick:t[0]||(t[0]=t=>e.$emit("onUnsubscribeClick",this.eventId))},{default:(0,s.w5)((()=>[(0,s.Uk)("Да, отписаться")])),_:1}),(0,s.Wm)(v.T,{color:"primary",flat:"",onClick:t[1]||(t[1]=(0,a.iM)((e=>o.show=!1),["stop"]))},{default:(0,s.w5)((()=>[(0,s.Uk)("Нет")])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])}var Ua={name:"EventUnsubscribeDialog",components:{IconAndText:ze},props:["visible","eventName","eventStart","eventEnd","eventId"],computed:{show:{get(){return this.visible},set(e){e||this.$emit("close")}},timeIntervalFormatted:function(){const e=Le()(this.start).format("YYYY-MM-DD"),t=Le()(this.end).format("YYYY-MM-DD");return e===t?{same_day:!0,start_time:Le()(e).locale("ru").format("LT"),end_time:Le()(t).locale("ru").format("LT"),date:Le()(e).locale("ru").format("LL")}:{same_day:!1,start:Le()(e).locale("ru").format("LLL"),end:Le()(t).locale("ru").format("LLL")}}}};const Ia=(0,w.Z)(Ua,[["render",Ea]]);var Ca=Ia,za={name:"MyAccount",components:{AccountInfo:ua,ApiError:Xt,NoEvents:Xe,MyEventInfoCard:ya,EventUnsubscribeDialog:Ca},data:()=>({selectedEventsTab:"upcoming",eventUnsubscribeDialog:{show:!1,eventName:null}}),async setup(){const e=(0,gn.oR)(),t=(0,et.iH)({}),n=(0,et.iH)({}),a=(0,et.iH)(null);try{t.value=await Y.getClientInfo(e.getters.userTgId)}catch(l){a.value=l}const r=(0,s.Fl)((()=>({name:t.value.name,phone:t.value.phone})));try{n.value=await Y.getClientEvents({tg_id:e.getters.userTgId,client_id:null})}catch(l){a.value=l}const i=(0,s.Fl)((()=>{const e=n.value.booking_next,t=[];for(const n of e)t.push({name:n?.bookingInfo?.subscription_service?.name_service,start:new Date(n?.bookingInfo?.dt_start),end:new Date(n?.bookingInfo?.dt_end),id:n.id_booking});return t})),o=(0,s.Fl)((()=>{const e=n.value.booking_previous,t=[];for(const n of e)t.push({name:n?.bookingInfo?.subscription_service?.name_service,start:new Date(n?.bookingInfo?.dt_start),end:new Date(n?.bookingInfo?.dt_end),id:n.id_booking});return t}));return{userData:r,userEventsUpcoming:i,userEventsPast:o,error:a}},methods:{showUnsubscribeEvent(e){this.eventUnsubscribeDialog.show=!0,this.eventUnsubscribeDialog.eventName=e.name,this.eventUnsubscribeDialog.eventStart=e.start,this.eventUnsubscribeDialog.eventEnd=e.end,this.eventUnsubscribeDialog.eventId=e.id},hideUnsubscribeEvent(){this.eventUnsubscribeDialog.show=!1,this.eventUnsubscribeDialog.eventName=null,this.eventUnsubscribeDialog.eventStart=null,this.eventUnsubscribeDialog.eventEnd=null,this.eventUnsubscribeDialog.eventId=null},async unsubscribeEvent(e){await Y.unsubscribeFromEvent(e).then((()=>{this.hideUnsubscribeEvent(),this.$router.go(this.$router.currentRoute.path)})).catch((e=>{console.log(e)}))}}};const Sa=(0,w.Z)(za,[["render",ta]]);var La=Sa,Aa={name:"MyAccountView",components:{MyAccount:La,ApiLoader:ht}};const Va=(0,w.Z)(Aa,[["render",qn]]);var Fa=Va;const Oa=[{path:"/:pathMatch(.*)*",name:"not-found",redirect:()=>"search"},{path:"/:pathMatch(.*)",name:"bad-not-found",redirect:()=>"search"},{path:"/",name:"home",redirect:()=>"search",meta:{goBackButton:!1}},{path:"/search",name:"search",component:wt,meta:{goBackButton:!1}},{path:"/my",name:"my_events",component:Fa,meta:{goBackButton:!1}},{path:"/event/:uuid",name:"event",component:yn,meta:{goBackButton:!0}},{path:"/user/:uuid",name:"user",component:$n,meta:{goBackButton:!0}},{path:"/about",name:"about",component:()=>n.e(443).then(n.bind(n,4242)),meta:{goBackButton:!0}}],Za=(0,ee.p7)({history:(0,ee.r5)(),routes:Oa,scrollBehavior(){return{top:0}}});var Ra=Za,Ya=(0,gn.MT)({state(){return{themeDark:!1,userData:{tg_id:null}}},getters:{userTgId(e){return e.userData.tg_id}},mutations:{setTheme(e,t){e.themeDark="dark"==t},setUserData(e,{tg_id:t}){e.userData.tg_id=t}},actions:{},modules:{}}),Ma=n(3045),Ba=n(626);const Na={mode:"auto",defaultCountry:"RU"};X();const Ha=(0,a.ri)(q).use(Ya).use(Ra).use(Q).use(Z).use(On).use(Ma.ZP,{locales:{"ru-RU":{firstDayOfWeek:2,masks:{}}}}).use(Ba.Z,Na);let $a=window.Telegram.WebApp;Ha.config.globalProperties.$tg=$a,Ha.mount("#app")},2133:function(e,t,n){"use strict";e.exports=n.p+"img/telegram-logo.1e4673c6.svg"}},t={};function n(a){var s=t[a];if(void 0!==s)return s.exports;var r=t[a]={id:a,loaded:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.loaded=!0,r.exports}n.m=e,function(){var e=[];n.O=function(t,a,s,r){if(!a){var i=1/0;for(u=0;u<e.length;u++){a=e[u][0],s=e[u][1],r=e[u][2];for(var o=!0,l=0;l<a.length;l++)(!1&r||i>=r)&&Object.keys(n.O).every((function(e){return n.O[e](a[l])}))?a.splice(l--,1):(o=!1,r<i&&(i=r));if(o){e.splice(u--,1);var c=s();void 0!==c&&(t=c)}}return t}r=r||0;for(var u=e.length;u>0&&e[u-1][2]>r;u--)e[u]=e[u-1];e[u]=[a,s,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){var e,t=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__};n.t=function(a,s){if(1&s&&(a=this(a)),8&s)return a;if("object"===typeof a&&a){if(4&s&&a.__esModule)return a;if(16&s&&"function"===typeof a.then)return a}var r=Object.create(null);n.r(r);var i={};e=e||[null,t({}),t([]),t(t)];for(var o=2&s&&a;"object"==typeof o&&!~e.indexOf(o);o=t(o))Object.getOwnPropertyNames(o).forEach((function(e){i[e]=function(){return a[e]}}));return i["default"]=function(){return a},n.d(r,i),r}}(),function(){n.d=function(e,t){for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}}(),function(){n.f={},n.e=function(e){return Promise.all(Object.keys(n.f).reduce((function(t,a){return n.f[a](e,t),t}),[]))}}(),function(){n.u=function(e){return"js/"+{443:"about",461:"webfontloader"}[e]+"."+{443:"0aee1c10",461:"1568d672"}[e]+".js"}}(),function(){n.miniCssF=function(e){}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){var e={},t="oleg-tg-webapp-vue:";n.l=function(a,s,r,i){if(e[a])e[a].push(s);else{var o,l;if(void 0!==r)for(var c=document.getElementsByTagName("script"),u=0;u<c.length;u++){var d=c[u];if(d.getAttribute("src")==a||d.getAttribute("data-webpack")==t+r){o=d;break}}o||(l=!0,o=document.createElement("script"),o.charset="utf-8",o.timeout=120,n.nc&&o.setAttribute("nonce",n.nc),o.setAttribute("data-webpack",t+r),o.src=a),e[a]=[s];var m=function(t,n){o.onerror=o.onload=null,clearTimeout(v);var s=e[a];if(delete e[a],o.parentNode&&o.parentNode.removeChild(o),s&&s.forEach((function(e){return e(n)})),t)return t(n)},v=setTimeout(m.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=m.bind(null,o.onerror),o.onload=m.bind(null,o.onload),l&&document.head.appendChild(o)}}}(),function(){n.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){n.p="/"}(),function(){var e={143:0};n.f.j=function(t,a){var s=n.o(e,t)?e[t]:void 0;if(0!==s)if(s)a.push(s[2]);else{var r=new Promise((function(n,a){s=e[t]=[n,a]}));a.push(s[2]=r);var i=n.p+n.u(t),o=new Error,l=function(a){if(n.o(e,t)&&(s=e[t],0!==s&&(e[t]=void 0),s)){var r=a&&("load"===a.type?"missing":a.type),i=a&&a.target&&a.target.src;o.message="Loading chunk "+t+" failed.\n("+r+": "+i+")",o.name="ChunkLoadError",o.type=r,o.request=i,s[1](o)}};n.l(i,l,"chunk-"+t,t)}},n.O.j=function(t){return 0===e[t]};var t=function(t,a){var s,r,i=a[0],o=a[1],l=a[2],c=0;if(i.some((function(t){return 0!==e[t]}))){for(s in o)n.o(o,s)&&(n.m[s]=o[s]);if(l)var u=l(n)}for(t&&t(a);c<i.length;c++)r=i[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(u)},a=self["webpackChunkoleg_tg_webapp_vue"]=self["webpackChunkoleg_tg_webapp_vue"]||[];a.forEach(t.bind(null,0)),a.push=t.bind(null,a.push.bind(a))}();var a=n.O(void 0,[998],(function(){return n(3666)}));a=n.O(a)})();
//# sourceMappingURL=app.b2030083.js.map